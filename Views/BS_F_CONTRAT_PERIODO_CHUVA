SELECT RA.AGREEMENT_ID    N_CONTRATO,
       RA.OPPORTUNITY_NO  N_OPORTUNIDADE,
       RAC.SERIAL_NO      N_SERIE_BEM_LOCADO,
       RA.RAIN_START_DATE DT_INICIO_PERIO_CHUVA,
       RA.RAIN_END_DATE   DT_FIM_PERIO_CHUVA,
       RA.RAIN_RATE       PORCEN_PERIO_CHUVA,
       RAC. MONTH_VALUE     VAL_MENSAL_LOCADO,
       (RAC.MONTH_VALUE - (RAC.MONTH_VALUE * RA.RAIN_RATE)) VAL_DESCONTO_BEM_LOCADO
 FROM IFSLAF.C_RECURRENT_AGREEMENT RA
 JOIN IFSLAF.C_REC_AGREEMENT_RENTED_ASSET RAC ON RA.AGREEMENT_ID = RAC.AGREEMENT_ID AND RA.OPPORTUNITY_NO = RAC.OPPORTUNITY_NO AND RA.CONTRACT = RAC.CONTRACT
   WHERE RA.RAIN_START_DATE IS NOT NULL
ORDER BY RA.AGREEMENT_ID, RAC.SERIAL_NO