SELECT 
    COMPANY AS ID_EMPRESA,
    BUDGET_YEAR || '_' || BUDGET_VERSION AS ID_ANO_VERSAO,
    LEDGER_ID AS ID_RAZAO,
    BUDGET_YEAR AS ANO,
    BUDGET_VERSION AS VERSAO_ORCAMENTO_IFS,
    DESCRIPTION AS DESCRICAO,
    BUDGET_FORMAT AS FORMATO_ORCAMENTO,
    BUDGET_STATUS AS STATUS,
    CASE
        WHEN BUDGET_YEAR IN(2021,2023) AND BUDGET_VERSION IN(1,2) THEN 'Budget'
        WHEN BUDGET_YEAR = 2021 AND BUDGET_VERSION = 2 THEN 'Forecast (3+9)'
        WHEN BUDGET_YEAR = 2022 AND BUDGET_VERSION = 1 THEN 'Forecast (3+9)'
        WHEN BUDGET_YEAR = 2023 AND BUDGET_VERSION = 4 THEN 'Forecast (9+3)'
        WHEN BUDGET_YEAR = 2023 AND BUDGET_VERSION = 3 THEN 'Forecast (6+6)'
   ELSE 'Budget' END AS VERSAO_ORC_BI,
   COALESCE(DESCRIPTION, 
       CASE
            WHEN BUDGET_YEAR IN(2021,2023) AND BUDGET_VERSION IN(1,2) THEN 'Budget'
            WHEN BUDGET_YEAR = 2021 AND BUDGET_VERSION = 2 THEN 'Forecast (3+9)'
            WHEN BUDGET_YEAR = 2022 AND BUDGET_VERSION = 1 THEN 'Forecast (3+9)'
            WHEN BUDGET_YEAR = 2023 AND BUDGET_VERSION = 4 THEN 'Forecast (9+3)'
            WHEN BUDGET_YEAR = 2023 AND BUDGET_VERSION = 3 THEN 'Forecast (6+6)'
       ELSE 'Budget' END) AS VERSIONAMENTO_PROPOSTO
FROM IFSLAF.BUDGET_VERSION1
