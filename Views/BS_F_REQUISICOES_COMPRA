select a.REQUISITION_NO                                                                                                                                 N_REQUISICAO,
       A.LINE_NO                                                                                                                                        N_LINHA_REQUISICAO,
       IFSLAF.PURCHASE_REQUISITION_API.Get_REQUISITION_DATE(requisition_no_ => A.REQUISITION_NO)                                                        DATA_REQUISICAO,
       IFSLAF.PURCHASE_REQUISITION_API.Get_State(requisition_no_ => A.REQUISITION_NO)                                                                   STATUS_REQ,
       A.STATE                                                                                                                                          STATUS_LINHA_REQ,
       ifslaf.PURCHASE_REQUISITION_API.get_REQUISITIONER_CODE(requisition_no_ => A.REQUISITION_NO)                                                      ID_REQUISITANTE,
       IFSLAF.PURCHASE_REQUISITIONER_API.Get_Requisitioner(ifslaf.PURCHASE_REQUISITION_API.get_REQUISITIONER_CODE(requisition_no_ => A.REQUISITION_NO)) DESC_REQUISITANTE,
       ifslaf.PURCHASE_REQUISITION_API.get_INTERNAL_DESTINATION(requisition_no_ => A.REQUISITION_NO)                                                    DESTINO_INTERNO,
       a.BUYER_CODE                                                                                                                                     ID_COMPRADOR,
       ifslaf.PURCHASE_BUYER_API.Get_Name(a.BUYER_CODE) 	                                                                                            DESC_COMPRADOR,
       ifslaf.PURCHASE_REQUISITION_API.get_AUTHORIZE_ID(a.REQUISITION_NO)                                                                               ID_AUTORIZADOR,
       ifslaf.COMM_METHOD_API.Get_Value('PERSON', ifslaf.PURCHASE_REQUISITION_API.get_AUTHORIZE_ID(a.REQUISITION_NO), IFSLAF.Comm_Method_Code_API.Decode('E_MAIL'), 1,'') EMAIL_AUTORIZADOR,
       A.COMPANY                                                                                                                                        ID_EMPRESA,
       A.CONTRACT                                                                                                                                       ID_SITE,
       A.code_a                                                                                                                                         ID_CODE_A_CONTA_CONTAB,
       a.code_b                                                                                                                                         ID_CODE_B_CR,
       a.code_d                                                                                                                                         ID_CODE_D_NATUREZA,
       a.code_e                                                                                                                                         ID_CODE_E_ATIVO,
       a.code_f                                                                                                                                         ID_CODE_F_PROJETO,
       a.code_g                                                                                                                                         ID_CODE_G_LINHA,
       A.code_h                                                                                                                                         ID_CODE_H_APR_CUSTO,
       a.code_i                                                                                                                                         ID_CODE_I_NEGOCIO,
       A.REQUEST_TYPE                                                                                                                                   TIPO_REQUISICAO,
       a.PART_NO                                                                                                                                        ID_MATERIAL,
       A.DESCRIPTION                                                                                                                                    DESC_MATERIAL,
       A.ORIGINAL_QTY                                                                                                                                   QTDE_SOLICITADA,
       A.WANTED_RECEIPT_DATE                                                                                                                            DATA_DESEJADA,
       A.UNIT_MEAS                                                                                                                                      ID_UNIDADE_MEDIDA,
       A.VENDOR_NO                                                                                                                                      ID_FORNECEDOR,
       IFSLAF.Supplier_API.Get_Vendor_Name(A.vendor_no)                                                                                                 DESC_FORNECEDOR,
       IFSLAF.purchase_req_line_part_api.Get_Qty_In_Purch_Unit(A.REQUISITION_NO,A.LINE_NO,A.RELEASE_NO)                                                 QTDE_COMPRADA,
       A.CONVERSION_FAC                                                                                                                                 FATOR_CONVERSAO,
       IFSLAF.Inquiry_Line_Part_Order_API.Get_Inquiry_No_From_Req(A.REQUISITION_NO, A.LINE_NO, A.RELEASE_NO)                                            N_COTACAO,
       A.ORDER_NO                                                                                                                                       ID_OC,
       A.ASSG_LINE_NO                                                                                                                                   ID_LINHA_OC,
       IFSLAF.PURCH_REQ_LINE_APPROVAL_API.Get_DATE_APPROVED(requisition_no_ => a.REQUISITION_NO,line_no_ => a.line_no,release_no_ => a.release_no,sequence_no_ => (select prla.sequence_no from ifslaf.purch_req_line_approval prla where prla.requisition_no = a.REQUISITION_NO and prla.line_no = a.line_no fetch first 1 rows only)) as DATA_APROVACAO,
       ifslaf.PURCHASE_AUTHORIZER_API.Get_Name(authorize_id_ =>  ifslaf.purch_req_approval_api.Get_Authorize_Id(requisition_no_ => a.REQUISITION_NO, sequence_no_ => (select prla.sequence_no from ifslaf.purch_req_line_approval prla where prla.requisition_no = a.REQUISITION_NO fetch first 1 rows only))) as DESC_APROVADOR,
       TO_DATE(a.objversion,'YYYY/MM/DD HH24:MI:SS')                                                                                                    ULT_ATUALIZACAO
       
FROM ifslaf.PURCHASE_REQ_LINE_PART a
