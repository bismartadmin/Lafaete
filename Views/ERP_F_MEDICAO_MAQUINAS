SELECT A.mb_id                                                                                                                           ID_BM,
       a.agreement_id                                                                                                                    N_CONTRATO,
       ifslaf.C_MEASUREMENT_BULLETIN_API.Get_State(mb_id_ => a.mb_id)                                                                    STATUS_BM,
       ifslaf.C_MEASUR_BULLETIN_STATUS_API.Get_Description(ifslaf.C_MEASUREMENT_BULLETIN_API.Get_Management_Status(mb_id_ => a.mb_id))   STATUS_GERENCIAL,
       ifslaf.C_MEASUREMENT_BULLETIN_API.Get_Customer_Id(mb_id_ => a.mb_id)                                                              ID_CLIENTE,
       ifslaf.CUSTOMER_INFO_API.Get_Name(ifslaf.C_MEASUREMENT_BULLETIN_API.Get_Customer_Id(mb_id_ => a.mb_id))                           DESC_CLIENTE,
       a.contract                                                                                                                        ID_SITE,
       COALESCE(IFSLAF.FA_OBJECT_API.GET_CODE_H(IFSLAF.COMPANY_SITE_API.Get_Company(A.CONTRAct), A.SERIAL_NO),a.contract)                ID_CODE_H_APR_CUSTO,
       a.serial_no                                                                                                                       SERIAL,
       a.catalog_no                                                                                                                      ID_MATERIAL,
       IFSLAF.SALES_PART_API.Get_Catalog_Desc(A.contract, A.CATALOG_NO)                                                                  DESC_MATERIAL,
       A.CATALOG_NO||'-'||A.CONTRACT                                                                                                     CHAVE_MATERIAL_SITE,
       ifslaf.C_MEASUREMENT_BULLETIN_API.Get_Start_Measurement_Date(mb_id_ => a.mb_id)                                                   DATA_INICIO_MEDICAO,
       ifslaf.C_MEASUREMENT_BULLETIN_API.Get_end_measurement_date(mb_id_ => a.mb_id)                                                     DATA_FIM_MEDICAO,
       a.START_MEASUREMENT_DATE                                                                                                          DATA_INICIO_MEDICAO_LINHA,
       a.end_measurement_date                                                                                                            DATA_FIM_MEDICAO_LINHA,
       a.agreement_guarantee                                                                                                             GARANTIA_CONTRATUAL,
       a.PROPORTIONAL_GUARANTEE                                                                                                          GARANTIA_PROPORCIONAL,
       a.RENTAL_PRICE                                                                                                                    HORA_LOCACAO,
       a.VARIABLE_HOUR_VALUE                                                                                                             HORA_VARIAVEL,
       a.HOURS_USED                                                                                                                      HORA_UTILIZADAS,
       a.HOURS_MAINTENANCE                                                                                                               HORA_MANUTENCAO,
       a.HOURS_TO_MEASURE                                                                                                                HORA_A_MEDIR,
       a.VALUE_TO_MEASURE                                                                                                                VALOR_A_MEDIR,
       A.BLOCKED_BILLING_DB                                                                                                              BLOQUEAR_FAT

 FROM IFSLAF.C_MEASUR_BULLETIN_MOTOR_AS A

 UNION ALL
 SELECT B.mb_id                                                                                                                           ID_BM,
       B.agreement_id                                                                                                                    N_CONTRATO,
       ifslaf.C_MEASUREMENT_BULLETIN_API.Get_State(mb_id_ => B.mb_id)                                                                    STATUS_BM,
       ifslaf.C_MEASUR_BULLETIN_STATUS_API.Get_Description(ifslaf.C_MEASUREMENT_BULLETIN_API.Get_Management_Status(mb_id_ => B.mb_id))   STATUS_GERENCIAL,
       ifslaf.C_MEASUREMENT_BULLETIN_API.Get_Customer_Id(mb_id_ => B.mb_id)                                                              ID_CLIENTE,
       ifslaf.CUSTOMER_INFO_API.Get_Name(ifslaf.C_MEASUREMENT_BULLETIN_API.Get_Customer_Id(mb_id_ => B.mb_id))                           DESC_CLIENTE,
       B.contract                                                                                                                        ID_SITE,
       COALESCE(IFSLAF.FA_OBJECT_API.GET_CODE_H(IFSLAF.COMPANY_SITE_API.Get_Company(B.CONTRAct), B.SERIAL_NO),B.contract)                ID_CODE_H_APR_CUSTO,
       B.serial_no                                                                                                                       SERIAL,
       B.catalog_no                                                                                                                      ID_MATERIAL,
       IFSLAF.SALES_PART_API.Get_Catalog_Desc(B.contract, B.CATALOG_NO)                                                                  DESC_MATERIAL,
       B.CATALOG_NO||'-'||B.CONTRACT                                                                                                     CHAVE_MATERIAL_SITE,
       ifslaf.C_MEASUREMENT_BULLETIN_API.Get_Start_Measurement_Date(mb_id_ => B.mb_id)                                                   DATA_INICIO_MEDICAO,
       ifslaf.C_MEASUREMENT_BULLETIN_API.Get_end_measurement_date(mb_id_ => B.mb_id)                                                     DATA_FIM_MEDICAO,
       B.START_MEASUREMENT_DATE                                                                                                          DATA_INICIO_MEDICAO_LINHA,
       B.end_measurement_date                                                                                                            DATA_FIM_MEDICAO_LINHA,
       B.agreement_guarantee                                                                                                             GARANTIA_CONTRATUAL,
       B.PROPORTIONAL_GUARANTEE                                                                                                          GARANTIA_PROPORCIONAL,
       B.hour_value                                                                                                                    HORA_LOCACAO,
       B.hour_value                                                                                                             HORA_VARIAVEL,
       B.HOURS_USED                                                                                                                      HORA_UTILIZADAS,
       B.HOURS_MAINTENANCE                                                                                                               HORA_MANUTENCAO,
       B.HOURS_TO_MEASURE                                                                                                                HORA_A_MEDIR,
       B.VALUE_TO_MEASURE                                                                                                                VALOR_A_MEDIR,
       B.BLOCKED_BILLING_DB                                                                                                              BLOQUEAR_FAT

 FROM IFSLAF.C_BULLETIN_FIXED_VARIABLE B
 WHERE b.catalog_type = 'Mat em estoque'
