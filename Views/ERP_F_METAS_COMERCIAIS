WITH SUBTB1(DATA,ANO,MES) AS
 (SELECT TO_DATE('01/04/2021','DD/MM/YYYY'),
         '2021',
         '04'
    FROM DUAL
  
  UNION ALL
  
  SELECT ADD_MONTHS(SUBTB1.DATA, 1),
         TO_CHAR(ADD_MONTHS(SUBTB1.DATA, 1), 'YYYY'),
         TO_CHAR(ADD_MONTHS(SUBTB1.DATA, 1), 'MM')
    FROM IFSLAF.SUBTB1
   WHERE SUBTB1.DATA < TO_DATE('01/12/2030','DD/MM/YYYY'))

SELECT B.REPRESENTATIVE_ID                                  ID_REPRESENTANTE,
       IFSLAF.PERSON_INFO_API.Get_Name(B.REPRESENTATIVE_ID) DESC_REPRESENTANTE,
       B.STATE                                              STATUS_VENDEDOR,
       SUBTB1.DATA                                          DATA_REFERENCIA,
       SUBTB1.ANO                                           ANO_REFERENCIA,
       SUBTB1.MES                                           MES_REFERENCIA,
       NVL(A.CF$_NEW_BUSINESS, 0)                           VALOR_META_CONTRATO,
       NVL(A.CF$_MONTHLY_INVOICING, 0)                      VALOR_META_FATURAMENTO
 FROM IFSLAF.BUSINESS_REPRESENTATIVE B
 CROSS JOIN IFSLAF.SUBTB1
 LEFT JOIN IFSLAF.LAF_GOAL_SELLERS_CLV A ON (B.REPRESENTATIVE_ID = A.CF$_IDSALESMAN AND SUBTB1.ANO = A.CF$_YEAR_PERIOD_DB AND CAST(SUBTB1.MES AS INT) = CAST(A.CF$_MONTH_REFERENCE_DB AS INT))
 WHERE B.REPRESENTATIVE_ID <> '*'
