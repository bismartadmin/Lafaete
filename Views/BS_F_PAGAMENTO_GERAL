SELECT b.company                                  ID_EMPRESA,
       b.PARENT_COMPANY                           ID_EMPRESA_PAGTO,
       b.series_id                                SERIE_PAGTO, 
       b.PAYMENT_ID                               ID_PAGTO,
       A.short_name                               ID_CONTA_MOVIMENTO,
       D.trans_id                                 ID_TRANSACAO,
       b.voucher_no                               N_LANCTO,
       b.VOUCHER_DATE                             DATA_LANCTO,
       b.pay_date                                 DATA_PAGTO, 
       b.VOUCHER_TYPE                             TIPO_LANCTO,
       b.payment_type_code                        TIPO_PAGTO,
       D.CODE_A                                   ID_CODE_A,
       D.CODE_B                                   ID_CODE_B,
       D.CODE_C                                   ID_CODE_C,
       D.CODE_D                                   ID_CODE_D,
       D.CODE_E                                   ID_CODE_E,
       D.CODE_F                                   ID_CODE_F,
       D.CODE_G                                   ID_CODE_G,
       D.CODE_H                                   ID_CODE_H,
       D.CODE_I                                   ID_CODE_I,
       D.CODE_J                                   ID_CODE_J,
       a.objversion                               OBJ_VERSION,
       A.CURR_AMOUNT                              VALOR,
       B.company||'-'||B.series_id||'-'||B.payment_id||'-'||A.SHORT_NAME               CHAVE_EMP_SERIE_PGTO_CONTA

FROM  IFSLAF.CASH_TRANSACTION_CU_QRY A 
JOIN IFSLAF.PAYMENT_PER_CURRENCY_GEN_QRY B ON A.company = B.company AND A.series_id = B.series_id AND A.payment_id = B.payment_id
outer apply (select D.CODE_A,
       D.CODE_B,
       D.CODE_C,
       D.CODE_D,
       D.CODE_E,
       D.CODE_F,
       D.CODE_G,
       D.CODE_H,
       D.CODE_I,
       D.CODE_J, D.trans_id from IFSLAF.PAY_ACCOUNTING_ROW_GEN_QRY D where D.company = B.company AND D.series_id = B.series_id AND D.payment_id = B.payment_id order by d.code_A fetch FIRST ROW only) d
