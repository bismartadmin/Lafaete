SELECT  F.COMPANY,
        F.GROUP_ID,
        F.SERIES_ID,
        F.INVOICE_NO, 
        IFSLAF.INVOICE_API.Get_Invoice_Id_Db(F.COMPANY, F.SUPPLIER_ID, 'SUPPLIER', F.SERIES_ID, F.INVOICE_NO) INVOICE_ID,
        SUM(G.NET_CURR_AMOUNT) VALOR_TOTAL_TITULO,
        NVL(SUM(NVL(G.NET_CURR_AMOUNT,0)) / (SELECT SUM(NVL(G.NET_CURR_AMOUNT,0)) FROM IFSLAF.C_INV_SUP_TRANS_GROUP k JOIN IFSLAF.INVOICE G ON G.INVOICE_ID = IFSLAF.INVOICE_API.Get_Invoice_Id_Db(K.COMPANY, K.SUPPLIER_ID, 'SUPPLIER', K.SERIES_ID, K.INVOICE_NO)  AND G.COMPANY = k.COMPANY  AND G.SERIES_ID = k.SERIES_ID AND G.PARTY_TYPE_DB = 'SUPPLIER' where k.COMPANY = f.company and k.group_id = F.GROUP_ID),1) AS PERCENT_GRUPO
 FROM IFSLAF.C_INV_SUP_TRANS_GROUP F
 LEFT JOIN  IFSLAF.INVOICE G  ON G.INVOICE_ID = IFSLAF.INVOICE_API.Get_Invoice_Id_Db(F.COMPANY, F.SUPPLIER_ID, 'SUPPLIER', F.SERIES_ID, F.INVOICE_NO)  AND G.COMPANY = F.COMPANY   AND G.SERIES_ID = F.SERIES_ID AND G.PARTY_TYPE_DB = 'SUPPLIER' AND g.identity = f.supplier_id
 GROUP BY F.COMPANY, F.GROUP_ID, F.SERIES_ID, F.INVOICE_NO, F.supplier_id, F.company
